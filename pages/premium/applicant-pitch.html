<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SwapIt - Home</title>

	<link href="../../dist/output.css" rel="stylesheet">

</head>

<body class="bg-white dark:bg-gray-900 text-black dark:text-white font-sans">

 <!-- Header -->
	<header class="flex items-center justify-between px-4 py-3 bg-white shadow">
    <img src="/img/logo/app-logo.png" alt="SwapIt Logo" class="h-8">
    <a href="../../all-users/settings.html"><div class="w-9 h-9 bg-gray-200 rounded-full flex items-center justify-center">
      <img src="/img/profile/profile.svg" class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 15c2.485 0 4.797.758 6.879 2.052M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
      
		</div></a>
  </header>
<header class="bg-[#0E4D22] text-white">
    <div class="max-w-md mx-auto relative px-4 pt-6 pb-5">
      <h1 class="text-center font-semibold">Become an Investor</h1>
      <!-- Close button only (right) -->
      <button
        type="button"
        aria-label="Close"
        class="absolute right-3 top-5 w-8 h-8 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 transition"
        onclick="window.location.href='premium-search.html'">
        ✕
      </button>
    </div>
    <!-- curved white top like in mock -->
    <div class="max-w-md mx-auto dark:bg-gray-900 bg-white rounded-t-3xl h-6"></div>
  </header>
	
<div class="p-4">
  <div class="max-w-2xl mx-auto mt-8 bg-white dark:bg-gray-800 p-6 rounded-lg shadow">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-lg font-bold">Applicant Pitch</h2>
      <button id="clearAllBtn" class="text-sm text-red-500 underline">Clear All</button>
    </div>

    <!-- Progress bar -->
    <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
      <div id="progressBar" class="bg-green-600 h-2 rounded-full" style="width: 33%;"></div>
    </div>

    <!-- Steps container -->
    <form id="pitchForm" class="space-y-6 p-4 dark:bg-gray-800">

      <!-- Step 1 -->
      <div class="step" id="step1">
        <label class="block text-green-700 font-medium mb-1 dark:text-gray-400">Name of Project *</label>
        <input id="projectTitle" type="text" placeholder="Project Title" required
          class="w-full border rounded px-3 py-2 mb-4 outline-none dark:bg-gray-900 dark:border-gray-700"/>

        <label for="projectCategory" class="block font-medium text-green-700 dark:text-gray-400">Project Category *</label>
        <select id="projectCategory" required
          class="mt-1 block w-full border border-gray-300 rounded-lg px-3 py-2.5 text-sm 
           bg-white dark:bg-gray-900 dark:border-gray-700 focus:ring-green-600 focus:border-green-600">
          <option value="">Select Category</option>
          <option>Organic Farming</option>
          <option>Food Processing</option>
          <option>Distribution</option>
          <option>Others</option>
        </select>

        <label class="block text-green-700 font-medium mb-1 dark:text-gray-400 mt-4">Funds Needed (₦)*</label>
        <input id="fundsNeeded" type="number" placeholder="Funds Needed (₦)" required
          class="w-full border rounded px-3 py-2 mb-4 outline-none dark:bg-gray-900 dark:border-gray-700"/>

        <div class="flex justify-end">
          <button type="button" id="next1" class="px-4 py-2 text-green-600 dark:text-green-200 opacity-50 cursor-not-allowed">
            Next &gt;
          </button>
        </div>
      </div>

      <!-- Step 2 -->
      <div class="step hidden" id="step2">
        <label class="block text-green-700 font-medium mb-1 dark:text-gray-400">Project Summary *</label>
        <textarea id="summary" placeholder="Project Summary" required
          class="w-full border rounded px-3 py-2 mb-4 outline-none dark:bg-gray-900 dark:border-gray-700"></textarea>

        <label class="block text-green-700 font-medium mb-1 dark:text-gray-400">Problems & Solutions *</label>
        <textarea id="solution" placeholder="Problem & Solution" required
          class="w-full border rounded px-3 py-2 mb-4 outline-none dark:bg-gray-900 dark:border-gray-700"></textarea>

        <label class="block text-green-700 font-medium mb-1 dark:text-gray-400">Expected Impact *</label>
        <textarea id="impact" placeholder="Expected Impact" required
          class="w-full border rounded px-3 py-2 mb-4 outline-none dark:bg-gray-900 dark:border-gray-700"></textarea>

        <label class="block text-green-700 font-medium mb-1 dark:text-gray-400">Timeline of Project *</label>
        <input id="timeline" type="text" placeholder="Timeline (e.g. 3 months)" required
          class="w-full border rounded px-3 py-2 mb-4 outline-none dark:bg-gray-900 dark:border-gray-700"/>

        <div class="flex justify-between">
          <button type="button" id="prev2" class="px-4 py-2 text-green-600 dark:text-green-200">&lt; Prev</button>
          <button type="button" id="next2" class="px-4 py-2 text-green-600 dark:text-green-200 opacity-50 cursor-not-allowed">
            Next &gt;
          </button>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="step hidden" id="step3">
        <label class="block dark:text-gray-400">Upload Business Proposal (PDF or Image) *</label>
        <input id="proposal" type="file" accept="application/pdf,image/png,image/jpeg" required
          class="w-full border rounded mb-6 p-3 dark:bg-gray-900 dark:border-gray-700"/>
        <small class="text-xs text-gray-500">Accepted formats: PDF, JPEG, PNG</small>

        <label class="block dark:text-gray-400 mt-4">Upload Cover Photo (Optional)</label>
        <input id="coverPhoto" type="file" accept="image/png,image/jpeg" class="w-full border rounded mb-6 p-3 dark:bg-gray-900 dark:border-gray-700"/>

        <label class="block dark:text-gray-400">Pitch Video (Optional)</label>
        <input id="video" type="file" accept="video/*" class="w-full border rounded mb-6 p-3 dark:bg-gray-900 dark:border-gray-700"/>

        <label class="block dark:text-gray-400">Record Voice Pitch (Optional)</label>
        <input id="voice" type="file" accept="audio/*" class="w-full border rounded mb-6 p-3 dark:bg-gray-900 dark:border-gray-700"/>

        <div class="flex flex-col gap-3 py-4">
          <button type="button" id="previewBtn"
            class="w-full bg-green-600 text-white py-2 rounded opacity-50 cursor-not-allowed">
            Preview Pitch
          </button>
          <button type="submit" id="submitBtn"
            class="w-full bg-yellow-500 text-white py-2 rounded opacity-50 cursor-not-allowed">
            Submit Pitch
          </button>
        </div>

        <div class="flex justify-start mt-4">
          <button type="button" id="prev3" class="px-4 py-2 text-green-600 dark:text-green-200">&lt; Prev</button>
        </div>
      </div>
    </form>
  </div>
	</div>
	
  <script>
  let step = 1;
  const totalSteps = 3;
  const fields = ["projectTitle", "projectCategory", "fundsNeeded", "summary", "solution", "impact", "timeline"];
  const files = ["proposal", "coverPhoto", "video", "voice"];

  // Restore saved data
  window.addEventListener("load", () => {
    const saved = localStorage.getItem("applicantPitchData");
    if (!saved) return;
    const data = JSON.parse(saved);

    fields.forEach(id => {
      if (data[id]) document.getElementById(id).value = data[id];
    });

    files.forEach(id => {
      const el = document.getElementById(id);
      if (data[id + "URL"]) {
        el.dataset.savedURL = data[id + "URL"];
        el.dataset.savedName = data[id + "Name"];
      }
    });

    updateStep();
    validateStep();
  });

  function updateStep() {
    document.querySelectorAll(".step").forEach((el, idx) => {
      el.classList.toggle("hidden", idx + 1 !== step);
    });
    document.getElementById("progressBar").style.width = `${(step / totalSteps) * 100}%`;
    validateStep();
  }

  function validateStep() {
    let valid = false;

    if (step === 1) {
      valid = fields.slice(0, 3).every(id => document.getElementById(id).value.trim());
    } else if (step === 2) {
      valid = fields.slice(3).every(id => document.getElementById(id).value.trim());
    } else if (step === 3) {
      const proposal = document.getElementById("proposal");
      valid = proposal.files.length > 0 || proposal.dataset.savedURL;
    }

    const nextBtn = document.getElementById(`next${step}`);
    if (nextBtn) {
      nextBtn.classList.toggle("opacity-50", !valid);
      nextBtn.classList.toggle("cursor-not-allowed", !valid);
    }

    // Check overall form completion
    const allValid =
      fields.every(id => document.getElementById(id).value.trim()) &&
      (document.getElementById("proposal").files.length > 0 ||
        document.getElementById("proposal").dataset.savedURL);

    const previewBtn = document.getElementById("previewBtn");
    const submitBtn = document.getElementById("submitBtn");

    previewBtn.disabled = !allValid;
    submitBtn.disabled = !allValid;

    previewBtn.classList.toggle("opacity-50", !allValid);
    previewBtn.classList.toggle("cursor-not-allowed", !allValid);
    submitBtn.classList.toggle("opacity-50", !allValid);
    submitBtn.classList.toggle("cursor-not-allowed", !allValid);
  }

  function saveData() {
    const data = {};
    fields.forEach(id => (data[id] = document.getElementById(id).value));

    files.forEach(id => {
      const el = document.getElementById(id);
      if (el.files.length > 0) {
        const f = el.files[0];
        data[id + "Name"] = f.name;
        data[id + "URL"] = URL.createObjectURL(f);
        data[id + "Type"] = f.type;
      } else if (el.dataset.savedURL) {
        data[id + "Name"] = el.dataset.savedName;
        data[id + "URL"] = el.dataset.savedURL;
      }
    });

    localStorage.setItem("applicantPitchData", JSON.stringify(data));
  }

  // 🔹 Revalidate all input, textarea, and select fields
  document.querySelectorAll("input, textarea, select").forEach(el => {
    el.addEventListener("input", () => {
      saveData();
      validateStep();
    });
    el.addEventListener("change", () => {
      saveData();
      validateStep();
    });
  });

  // 🔹 Specifically ensure file uploads trigger validation immediately
  files.forEach(id => {
    const el = document.getElementById(id);
    el.addEventListener("change", () => {
      saveData();
      setTimeout(validateStep, 100); // wait briefly to catch file data
    });
  });

  // Navigation
  document.getElementById("next1").onclick = () => {
    step = 2;
    updateStep();
  };
  document.getElementById("next2").onclick = () => {
    step = 3;
    updateStep();
  };
  document.getElementById("prev2").onclick = () => {
    step = 1;
    updateStep();
  };
  document.getElementById("prev3").onclick = () => {
    step = 2;
    updateStep();
  };

  // Preview
  document.getElementById("previewBtn").addEventListener("click", e => {
    e.preventDefault();
    saveData();
    window.open("applicant-preview.html", "Preview", "width=900,height=750,scrollbars=yes");
  });

  // Clear all data
  const clearBtn = document.getElementById("clearAllBtn");
  if (clearBtn) {
    clearBtn.onclick = () => {
      if (confirm("Clear all entered data?")) {
        localStorage.removeItem("applicantPitchData");
        window.location.reload();
      }
    };
  }

  updateStep();
</script>

	
	<script src="../../js/script.js"></script>
</body>
</html>
